<head>
    <title> Codeverter </title>
    <script src="//code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="./css/mazeGame.css">

</head>

<body>

<div id="promotion"> 
    <link type="text/css" rel="stylesheet" href="./css/landingPage.css">

    <div class="topnav" id="myTopnav"> 
      <a href="#admin">The Problem</a>
      <a href="#theproduct">The Solution</a>
      <a href="#buy">Try it out!</a>
    </div>

    <div id="title" class="title">
        <h3>&nbsp &nbsp &nbsp &nbsp   Codeverter   &nbsp &nbsp &nbsp  &nbsp </h3>
    </div>

    <div id="one" data-color="#ffb366">                                 
        <div id="mvpContainer">
            <img id="mvp" width="900" height="500" src="./images/loginScreenshot.png">
        </div>
    </div>


    <div id="two" data-color="#ffa64d">    
        <h2 id="theproduct"> The Problem </h2>
        <p>In some shape or form, technological advancements shape and control just about every aspect of our lives today. As a result children today are growing up in a very different world than previous generations. Currently in Australia more than 90% of the workforce will need digital skills to perform their roles and in the next 2-5 years 60% of students will be studying or training for positions that will become largely automated. Thus in this digital age it’s important for students to start learning how to program from a younger age.
    <br><br>
    However, when trying to do so, we are faced with a few challenges. It’s not easy to get young people to not only learn such complex concepts, but also get them to take interest in programming. And, not all teachers are equipped with the skills to teach programming. There needs to be a resource that inexperienced teachers can use to aid the classroom, that will engage primary school aged students.
     </p>
        <div class="clear"></div>
    </div>

    <hr>

    <article id="five" data-color="#ff9933">
        <h1 id="how"> The Solution </h1>
        <p>
        Codeverter aims to make learning how to code within classrooms a more social experience in order to boost interest and participation.
        Basically, a teacher creates their own profile on Codeverter and then sets up a “virtual classroom” that their students will sign-on to with their own accounts.
        Codeverter allows the teachers to create lesson plans that include learning modules and acitivities for the students to then test out what they've learnt. 
        The success of Codeverter relies on the social aspect of the app and it's what makes it different from our competitors.
        It makes use of the current common class setup of one big class display screen and several other indivdual student screens. 
        The main display screen is what connects the acitivites happening on the student's individual screens with the rest of the class.<br><br>
        For example in one of the designed activities the main class display screen shows an alien attack against the class.
        The student must complete coding challenges to upgrade their space ships in order to help the class defeat the attackers together.
        With games designed as so students work together as a class and also compete against each other to build the best spacecraft.
        </p>
    </article>  

    <article id="six" data-color="#ff8c1a">
        <img id="mvp" width="900" height="580" src="./images/teacherGif.gif">
    </article>  

    <hr>

    <article id="four" data-color="#ff8000">
        <h1 id="buy"> Try it out! </h1>
        <p id="buytext">Click below to try out Codeverter!</p>
        <br><br>
                <input type="button" id="buybutton" value="Start"></input>

        <div class="clear"></div>
    </article>                                   
</div>

<!-- The Login Page -->
<div id="login">
    <h1 id="loginTitle"> CODEVERTER </h1>
    <input type="button" id="teacherAccount" class="loginButton" value="I am a teacher"></input>
    <input type="button" id="studentAccount" class="loginButton" value="I am a student"></input>
</div>




<!-- The Lesson Plan Page -->
<div id="lessonPlan">
    <input type="button" class="logoutButton" value="Logout"/>

    <div>
        <h1 id="lessonPlanTitle" class="header"> Today's Lesson Plan </h1>
    </div>

    <a id="dashboard">Visit Dashboard</a>
    
    <div class="header">
    <h3> Learning Content </h3>
    </div>
    
    <div id="feed">
        <div class="feed-item">
            <div class="feed-title">Variable Assignment</div>
        </div>
        
        <div class="feed-item">
            <div class="feed-title">If Statements</div>
        </div>
        
        
        <div class="feed-item">
            <div class="feed-title">What are for loops?</div>
        </div>
        
        <div class="feed-item">
            <div class="feed-title">What are while loops?</div>
        </div>
    </div>
 
    <div id="activityTitle" class="header">
        <h3> Activities </h3>
    </div>

    <div id="activateLessonButton">
        <input type="button" id="activateLesson" class="button" value="Activate Lesson"/>

    </div>
    
    <div id="enterLessonButton">
        <input type="button" id="enterLesson" class="button" value="Enter Lesson"/>
    </div>

    <div id="feed">
        <div id="feedItem1" class="feed-item">
            <div onclick="location.href='index.html" class=" feed-title">Maze Game</div>
        </div>
        
        <div id=spacegame class="feed-item">
            <a class="feed-title">Space Game</a>
        </div>
    </div> 
</div>

<input id="backBtn" type="button" class="backButton" value="Back to Lesson Plan"/>


<div id = "gameplay">
    <h1 id="lessonPlanTitle" class="header"></h1>

    <div id="teacherTitle"></div>



   <div id="profilepanel" class="w3-panel">
        <div class="card">
            <img id="circle">
        <div id="playerTitle"></div><br>
        <div id="gameTitle"></div>
        <div id="counterTitle"></div>
        </div>
        

        
    </div>


    <!-- Challenges will be like a step by step form -->
    <div id="challenge">
        <b>Challenge #1 ***</b> <br>
        Complete the code that will print numbers from 1-5; <br>
        
        int i; <br>
        for(<input id="Q1Answer" type="text" name="lname">) {<br>
           &emsp; print i;<br>
        }<br>
        Answer is "correct"<br>
        <br><br>
        <button id="submit" onclick="checkAnswer()" type="button" class="buttonMove">Check</button>
        <br><br>
        <button id="right" type="button" class="buttonMove">Right</button>
        <button id="left" type="button" class="buttonMove">Left</button>
        <button id="up" type="button" class="buttonMove">Up</button>
        <button id="down" type="button" class="buttonMove">Down</button>

    </div>
    
        
    <canvas id="maze" width="450px" height="450px">
    </canvas>
</div>



</body>
<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
<script src="https://code.jquery.com/jquery-1.11.1.js"></script>

<script src="/static/game.js"></script>
 
<script>
var playerNumber = -1;
var canvas = $('#maze');
var grass = new Image();
grass.src = "images/grass.png"

var dirt = new Image();
dirt.src = "images/dirt.png"


var spot = new Image();
spot.src = "images/spot.png"
// Maze canvas key: 1 for wall, 0 for path and -1 for the goal
var maze = [
    [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [ 1, 1, 1, 1, 0, 1, 1, 1, 1, 0],
    [ 1, 0, 0, 0, 0, 0, 0, 0, 1, 0],
    [ 0, 0, 0, 1, 0, 1, 1, 0, 1, 0],
    [ 1, 1, 1, 1,-1, 1, 1, 0, 1, 0],
    [ 0, 0, 0, 1, 0, 0, 0, 0, 1, 0],
    [ 1, 0, 0, 0, 0, 1, 1, 0, 1, 0],
    [ 1, 0, 1, 0, 0, 1, 1, 0, 0, 0],
    [ 1, 1, 1, 1, 0, 1, 0, 1, 1, 0],
    [ 0, 0, 0, 0, 0, 1, 0, 0, 0, 0]
];
//Draw the maze
function createMaze(){



    // Create a plane game board canvas
    var board = canvas[0].getContext('2d');
    var width = canvas.width(); // The width of the matrix
    
    var blockSize = width/maze.length;
    
    board.setTransform(1, 0, 0, 1, 0, 0);
    // Creating a square canvas
    board.clearRect(0, 0, width, width);
    board.fillStyle = "blue";
    for(var y = 0; y < maze.length; y++){
        for(var x = 0; x < maze[y].length; x++){
            if(maze[y][x] === -1){
                
                board.beginPath();
                board.lineWidth = 5;
                board.strokeStyle = "red";
                board.moveTo(x*blockSize, y*blockSize);
                board.lineTo((x+1)*blockSize, (y+1)*blockSize);
                board.moveTo(x*blockSize, (y+1)*blockSize);
                board.lineTo((x+1)*blockSize, y*blockSize);
                board.stroke();
                board.drawImage(spot, x * blockSize, y * blockSize, blockSize, blockSize)


            } else if(maze[y][x] === 0){
                board.fillRect(x*blockSize, y*blockSize, blockSize, blockSize);

                board.drawImage(dirt, x * blockSize, y * blockSize, blockSize, blockSize)
            }
        }
    }
    board.fillStyle = "green";
    //Loop through the maze array drawing the walls and the goal
    var offset = blockSize/10;
    for(var y = 0; y < maze.length; y++){
        for(var x = 0; x < maze[y].length; x++){
            //Draw a wall
            if(maze[y][x] === 1){
                board.fillRect(x*blockSize, y*blockSize, blockSize, blockSize);

                board.drawImage(grass, (x * blockSize)-offset, (y * blockSize)-offset, blockSize + 2*offset, blockSize + 2*offset)
            }
        }
    }
}
createMaze();

var start = 0;
var logged = -1;
if(start == 0) {
    document.getElementById("maze").style.display = "none";
    document.getElementById("challenge").style.display = "none";
    document.getElementById("login").style.display = "none";
    document.getElementById("profilepanel").style.display = "none";
    document.getElementById("maze").style.display = "none";
    document.getElementById("backBtn").style.display = "none";

}


$("#buybutton").click(function(){
    $('link[href="./css/mazegame.css"]').prop('disabled', true);

    logged = 0;
    start = 1;
    document.getElementById("login").style.display = "block"; 
    document.getElementById("promotion").style.display = "none";
    document.getElementById("profilepanel").style.display = "none";

    document.getElementById("maze").style.display = "none";
    document.getElementById("challenge").style.display = "none";
    document.body.style.backgroundImage =  'url(./images/rocketWallpaper.png)';
    document.body.style.backgroundRepeat = "no-repeat";
    document.body.style.backgroundSize = "cover";
    $('link[href="./css/landingPage.css"]').prop('disabled', true);
});



if(logged == 0) {
    document.getElementById("profilepanel").style.display = "none";
    document.getElementById("backBtn").style.display = "none";

    document.getElementById("maze").style.display = "none";
    document.getElementById("challenge").style.display = "none";
    document.body.style.backgroundImage =  'url(./images/rocketWallpaper.png)';
    document.body.style.backgroundRepeat = "no-repeat";
    document.body.style.backgroundSize = "cover";
}

var lessonPlan = 0;
var lessonActive = 0;

if(lessonPlan == 0) {
    document.getElementById("lessonPlan").style.display = "none";
}
      
$("#teacherAccount").click(function(){
    logged = 1;
    lessonPlan = 1;
    document.getElementById("login").style.display = "none"; 
    document.getElementById("lessonPlan").style.display = "block";
    document.getElementById("enterLesson").style.display = "none";
        document.getElementById("profilepanel").style.display = "none";
        
            document.getElementById("backBtn").style.display = "none";

            document.getElementById("activateLesson").style.display = "block";

    document.body.style.backgroundImage =  'url(./images/lessonPlan.png)';
    document.body.style.backgroundRepeat = "no-repeat";
    document.body.style.backgroundSize = "cover";
});

$("#studentAccount").click(function(){
    logged = 2;
    lessonPlan = 2
    document.getElementById("login").style.display = "none"; 
    document.getElementById("lessonPlan").style.display = "block";
    document.getElementById("activateLesson").style.display = "none";
        document.getElementById("profilepanel").style.display = "none";
    document.getElementById("backBtn").style.display = "none";

    document.body.style.backgroundImage =  'url(./images/lessonPlan.png)';
    document.body.style.backgroundRepeat = "no-repeat";
    document.body.style.backgroundSize = "contains";
});


$("#dashboard").click(function(){
    open("./dashboard" , '_blank'); 
});

$("#spacegame").click(function(){
    if(logged == 2) {
        open("./student_setup" , '_blank'); 
    } else {
        open("./teacher_setup" , '_blank'); 
    }
    
});

$("#activateLesson").click(function(){
    if(lessonActive == 0) {
        document.getElementById('activateLesson').setAttribute("style", "background: #00e6b8;");
        document.getElementById('feedItem1').setAttribute("style", "background: #00e6b8;");
        document.getElementById('activateLesson').value="Lesson Active";
        document.getElementById('enterLesson').style.display = "block";  
        lessonActive = 1;
    } else {
        document.getElementById('activateLesson').setAttribute("style", "background: grey;");
        document.getElementById('feedItem1').setAttribute("style", "background: white;");
        document.getElementById('activateLesson').value="Activate Lesson";
        document.getElementById('enterLesson').style.display = "none";  
        lessonActive = 0;
    }  
});

var inLesson = 0;


$("#enterLesson").click(function(){
    document.getElementById("backBtn").style.display = "block";

    document.getElementById('lessonPlan').style.display = "none";  
    if(lessonPlan == 1) {
        document.getElementById("maze").style.left = "35%";
        document.getElementById("maze").style.display = "inline-block";
        document.getElementById("challenge").style.display = "none";
            document.getElementById("profilepanel").style.display = "none";

        socket.emit('new player', "teacher");
        inLesson = 1
    } else if (lessonPlan == 2) {
        document.getElementById("maze").style.display = "inline-block";
        document.getElementById("challenge").style.display = "inline-block";
            document.getElementById("profilepanel").style.display = "block";

        socket.emit('new player', "student");
        inLesson = 2;
    }
});


$(".backButton").click(function(){
 var socket = io();
    console.log("BACK!");
    document.getElementById('lessonPlan').style.display = "none";  
        document.getElementById("backBtn").style.display = "none";

    if(inLesson != 0) {
    
        inLesson = 0;
        if(lessonPlan == 1) { // Teacher
            document.getElementById("login").style.display = "none"; 
            document.getElementById("maze").style.display = "none"; 
            document.getElementById("challenge").style.display = "none";
            document.getElementById("profilepanel").style.display = "none";
            document.getElementById("enterLesson").style.display = "block";
            document.getElementById("activateLesson").style.display = "block";

            document.getElementById("lessonPlan").style.display = "block";

            document.body.style.backgroundImage =  'url(./images/lessonPlan.png)';
            document.body.style.backgroundRepeat = "no-repeat";
            document.body.style.backgroundSize = "cover";
            
        }else if (lessonPlan == 2) { // Student 
            var socket = io();

            console.log("BACK2!");

            document.getElementById("login").style.display = "none"; 
            document.getElementById("maze").style.display = "none"; 
            document.getElementById("challenge").style.display = "none";
            document.getElementById("profilepanel").style.display = "none";
            document.getElementById("enterLesson").style.display = "block";   
            
            document.getElementById("lessonPlan").style.display = "block";

            document.body.style.backgroundImage =  'url(./images/lessonPlan.png)';
            document.body.style.backgroundRepeat = "no-repeat";
            document.body.style.backgroundSize = "contains";
            
            socket.emit("removePlayer");
            

        }
    }
});


$(".logoutButton").click(function(){
            document.getElementById("login").style.display = "block"; 
            document.getElementById("maze").style.display = "none"; 
            document.getElementById("challenge").style.display = "none";
            document.getElementById("profilepanel").style.display = "none";
            //document.getElementById("enterLesson").style.display = "none";
            //document.getElementById("activateLesson").style.display = "none";

            document.getElementById("lessonPlan").style.display = "none";

            document.body.style.backgroundImage =  'url(./images/rocketWallpaper.png)';
            document.body.style.backgroundRepeat = "no-repeat";
            document.body.style.backgroundSize = "cover";
            
            
            lessonPlan = 0;
            lessonActive = 0;
            inLesson = 0;
            start = 0;      
            logged = -1;
            playerNumber = -1;
 
});




//Check to see if the new space is inside the maze and not a wall
function canMove(x, y){
    return (y>=0) && (y<maze.length) && (x >= 0) && (x < maze[y].length) && (maze[y][x] != 1);
}
function checkAnswer() {
    var socket = io();
    
    
    
    if(document.getElementById('Q1Answer').value == "correct") {
        document.getElementById("challenge").style.background = "green";
        document.getElementById('Q1Answer').value = "";
        socket.emit('addCounter', 3);
    } else {
        document.getElementById("challenge").style.background = "red";
        
    }
}
$(function () {
   
    var socket = io();
    
    
    //socket.emit('new player', "teacher");
    
    var width = canvas.width(); // The width of the matrix
    
    var blockSize = width/maze.length;
    var half = blockSize/2;
    // Create a plane game board canvas
    var board = canvas[0].getContext('2d');
    board.setTransform(1, 0, 0, 1, 0, 0);
    // Creating a square canvas
    board.clearRect(0, 0, width, width);
    
    board.fillStyle = "green";
    
    //Loop through the maze array drawing the walls and the goal
    for(var y = 0; y < maze.length; y++){
        for(var x = 0; x < maze[y].length; x++){
            //Draw a wall
            if(maze[y][x] === 1){
                board.fillRect(x*blockSize, y*blockSize, blockSize, blockSize);
            }
            //Draw the goal
            else if(maze[y][x] === -1){
                board.beginPath();
                board.lineWidth = 5;
                board.strokeStyle = "red";
                board.moveTo(x*blockSize, y*blockSize);
                board.lineTo((x+1)*blockSize, (y+1)*blockSize);
                board.moveTo(x*blockSize, (y+1)*blockSize);
                board.lineTo((x+1)*blockSize, y*blockSize);
                board.stroke();
            }
        }
    }
    var colours = ["blue", "orange", "purple", "pink"];
    
    socket.on('state', function(players){
      createMaze();
      var colourCounter = 0;
      board.strokeStyle = "black";
      for (var id in players) {
          var player = players[id];
          console.log(player.x+"," + player.y);
          board.beginPath();
          board.fillStyle = colours[player.name];
          board.arc(player.x*blockSize+half, player.y*blockSize+half, 2*(blockSize/5), 0, 2*Math.PI);
          board.fill();
          board.stroke();
          colourCounter++;
      }
    });
    
    
    socket.on('counterUpdate', function(currentCounter){
        if(playerNumber != 'x') 
            document.getElementById('counterTitle').innerHTML = "Number of moves available: " + currentCounter;
            if(currentCounter == 0) {
                document.getElementById("challenge").style.background = "white";
                document.getElementById("submit").disabled = "";

            }
            if(currentCounter != 0) {
                document.getElementById("submit").disabled = "disabled";
            }
            
    });
    
    /*
    socket.on('refresh', function(){
      location.reload();
    });
    */    
    
    
    socket.on('playerTitle', function(playerID){  
        console.log("Player ID " + playerID);
        if(playerNumber == -1) {
            playerNumber = playerID;
            
            if(playerID == "teacher") {
                //document.getElementById("challenge").style.display = "none";
                document.getElementById('teacherTitle').innerHTML = "Class 4K Maze";
            } else {
                document.getElementById('playerTitle').innerHTML = "Player ID: " + playerID;
            }
      
        document.getElementById('circle').setAttribute("style", "background:" + colours[playerNumber] + ";");
}
    });
    
        
    socket.on('win', function(playerID){    
        if(logged == 2) {
                document.getElementById("maze").style.visibility = "hidden";                
                document.getElementById("challenge").style.visibility = "hidden";
                                document.getElementById("challenge").style.visibility = "hidden";
document.getElementById('counterTitle').style.visibility = "hidden";

        }
        document.getElementById('gameTitle').innerHTML = "Winner is player: " + playerID;
    });
    
    
$(document).ready(function() {
	setTimeout(function() {
		$("#title").removeClass("title");
	}, 800)
});

var one = "#ffb366",
		two = "#ffa64d",
		three = "#ff9933",
		four = "#ff8c1a",
		five = "#ff8000";

$(window).on("scroll touchmove", function() {
        if(start == 0){
            if ($(document).scrollTop() >= $("#myTopnav").position().top) {
                            $('body').css('background', $("#one").attr("data-color"));
            };
            
            if ($(document).scrollTop() >= $("#one").position().top) {
                    $('body').css('background', $("#one").attr("data-color"));
            };
            
            if ($(document).scrollTop() > $("#two").position().top) {
                    $('body').css('background', $("#two").attr("data-color"))
            };
            
            if ($(document).scrollTop() > $("#three").position().top) {
                    $('body').css('background', $("#three").attr("data-color"))
            };
        }
});
    
    
    
    
});
/*
function clearGame() {
    var socket = io();
    socket.emit('clearGame');
}
*/
//createMaze();
</script>